@using PagedList.Mvc
@*@model PagedList.IPagedList<ToDo.Net.Models.ToDoList>*@
@model  PagedList.IPagedList<ToDo.Net.Models.ToDoList>

@{
    /**/

    ViewBag.Title = "Index";
}

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
<link href="~/Content/Site.css" rel="stylesheet" />

<h2>Completed Task Lists</h2>

<br />

<br />

<table id="TaskTable" class="table table-striped table">
    <thead>
        <tr>
            <th>Task</th>
            <th>Due Date</th>
            <th>Task Priority</th>
            <th>Date Completed</th>
            <th>Days Taken Complete</th>
            <th>Actions</th>
        </tr>
    </thead>

    <tbody>
        @foreach (var item in Model)
        {
            <tr>
                @{
                    var color = "#fff";
                    if (item.DaysToComplete > 4)
                    {
                        color = "red";
                    }
                    else if (item.DaysToComplete >= 3)
                    {
                        color = "yellow";
                    }
                    else if (item.DaysToComplete < 2)
                    {
                        color = "green";
                    }
                }
                <td>
                    @Html.DisplayFor(modelItem => item.Task)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.DueDate)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.TaskPriority)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.DateCompleted)
                </td>
                <td style="text-align: center;color: @color">
                    <strong>@Html.DisplayFor(modelItem => item.DaysToComplete)</strong>
                </td>

                @using (Html.BeginForm())
                {
                    @Html.AntiForgeryToken()
                    <td width=130px>
                        @Html.ActionLink(" ", "Edit", new { id = item.ID }, new { @class = "btn btn-primary glyphicon glyphicon-pencil" })
                        <a onclick="Delete(@item.ID)" class="btn btn-danger"><i class="fas fa-times" style="color:white"></i></a>

                    </td>
                }
            </tr>


        }
    </tbody>

    <tfoot>
        <tr>
            <td colspan="13"> TOTAL TASKS : @Model.Count()</td>
        </tr>
    </tfoot>
</table>

<div class="pagination">
    @*Page @(Model.PageCount < Model.PageNumber ? 0 : Model.PageNumber) of @Model.PageCount*@
    @Html.PagedListPager(Model, page => Url.Action("Completed", new { page }))
</div>

<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />

<div>
    <a href="@Url.Action("Index","ToDoLists")" class="btn btn-primary btn-lg">
        <span class="fas fa-angle-double-left" aria-hidden="true"></span>
        Back To Tasks
    </a>
</div>

@section Scripts {
    <script src="https://kit.fontawesome.com/de77b81930.js"></script>

    <script>
        $(function () {
            var successMessage = '@TempData["SuccessMessage"]'
            if (successMessage != '')
                alertify.success(successMessage)

        });

        function Delete(id) {
            alertify.confirm('Loadplanner', 'Are you sure you want to Delete this Commodity', function () {
                window.location.href = '@Url.Action("Delete","Commodities")/' + id;
            },null)
        }

    </script>

}
